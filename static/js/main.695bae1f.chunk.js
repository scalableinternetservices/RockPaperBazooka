(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{43:function(e,t,a){e.exports=a(78)},48:function(e,t,a){},49:function(e,t,a){},74:function(e,t,a){},75:function(e,t,a){},76:function(e,t,a){},78:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(38),l=a.n(s),o=(a(48),a(4)),c=a(8),u=a(10),i=a(9),m=a(11),h=(a(49),a(17)),g=a(79),d=a(80),p=a(81),f=a(21),b=a(3),E=a.n(b);E.a.defaults.headers.post["Content-Type"]="application/json";var v=function e(){Object(o.a)(this,e)};v.users=function(){return E.a.defaults.baseURL=localStorage.getItem("url"),E.a.get("/users")},v.getUser=function(e){return E.a.defaults.baseURL=localStorage.getItem("url"),E.a.get("/users/".concat(e))},v.deleteUser=function(e){return E.a.defaults.baseURL=localStorage.getItem("url"),E.a.delete("/users/".concat(e))},v.createUser=function(e){return E.a.defaults.baseURL=localStorage.getItem("url"),E.a.post("/users",e)},v.login=function(e){return E.a.defaults.baseURL=localStorage.getItem("url"),E.a.post("/login",{name:e})},v.match=function(e){return E.a.defaults.baseURL=localStorage.getItem("url"),E.a.get("/matches/".concat(e))},v.matches=function(){return E.a.defaults.baseURL=localStorage.getItem("url"),E.a.get("/matches")},v.createMatch=function(e){return E.a.defaults.baseURL=localStorage.getItem("url"),E.a.post("/matches",e)},v.joinMatch=function(e,t){return E.a.defaults.baseURL=localStorage.getItem("url"),E.a.patch("/matches/".concat(e,"/join"),t)},v.gameConfiguration=function(e){return E.a.defaults.baseURL=localStorage.getItem("url"),E.a.get("/game_configurations/".concat(e))},v.gameConfigurations=function(){return E.a.defaults.baseURL=localStorage.getItem("url"),E.a.get("/game_configurations")},v.gameConfiguration=function(e){return E.a.defaults.baseURL=localStorage.getItem("url"),E.a.get("/game_configurations/".concat(e))},v.createGameConfigurations=function(e){return E.a.defaults.baseURL=localStorage.getItem("url"),E.a.post("/game_configurations",e)},v.messages=function(e){return E.a.defaults.baseURL=localStorage.getItem("url"),E.a.get("/matches/".concat(e,"/messages"))},v.createMessage=function(e,t){return E.a.defaults.baseURL=localStorage.getItem("url"),E.a.post("/matches/".concat(e,"/messages"),t)},v.play=function(e,t,a){return E.a.defaults.baseURL=localStorage.getItem("url"),E.a.patch("/matches/".concat(e,"/play"),{player_id:t,game_input:a})},v.determineWinner=function(e,t,a){var n=0;return e.forEach((function(e,r){var s=t[r],l=a.indexOf(e),o=a.indexOf(s);(l+1)%a.length===o?n--:(o+1)%a.length===l&&n++})),n},v.isGameOver=function(e,t,a){return e.length===a.num_matches&&t.length===a.num_matches};var y=v,_=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(i.a)(t).call(this,e))).onChange=function(e){"number"===e.target.type?a.setState(Object(h.a)({},e.target.name,parseInt(e.target.value))):a.setState(Object(h.a)({},e.target.name,e.target.value))},a.onSubmit=function(e){e.preventDefault(),console.log(a.state),y.createGameConfigurations(a.state).then((function(e){a.setState({redirect:!0}),console.log(e)})).catch(console.log)},a.state={name:"",num_matches:0,input_set:"",redirect:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.state.redirect?r.a.createElement(f.a,{to:"/matches"}):null,r.a.createElement("h2",null,"Create Configuration"),r.a.createElement("p",null,'Input set must be a list of the inputs that can be used for the game, separated by spaces. Ex: "rock paper scissors bazooka". Every input beats the input directly before it, and loses to the input directly after it (in a loop). In the example above, paper beats rock, scissors beats paper, bazooka beats scissors, and rock beats bazooka.'),r.a.createElement(g.a,{onSubmit:this.onSubmit},r.a.createElement(d.a,{name:"name",placeholder:"name",onChange:this.onChange}),r.a.createElement("br",null),r.a.createElement(d.a,{name:"num_matches",type:"number",placeholder:"number of matches",onChange:this.onChange}),r.a.createElement("br",null),r.a.createElement(d.a,{name:"input_set",placeholder:"input set",onChange:this.onChange}),r.a.createElement("br",null),r.a.createElement(p.a,{type:"submit",color:"primary"},"Submit")))}}]),t}(r.a.Component),S=(a(74),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(i.a)(t).call(this,e))).onChange=function(e){"number"===e.target.type?a.setState(Object(h.a)({},e.target.name,parseInt(e.target.value))):a.setState(Object(h.a)({},e.target.name,e.target.value))},a.clearForm=function(){a.setState({name:""})},a.onSubmit=function(e){e.preventDefault(),console.log(a.state),localStorage.setItem("url",a.state.url),y.login(a.state.name).then((function(e){a.props.updateName(a.state.name,e.data.id),a.clearForm(),a.setState({loggedIn:!0})})).catch((function(e){alert("Shouldn't be possible to get there")}))},a.state={name:"",loggedIn:!1,url:"http://localhost:3000/"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"form"},this.state.loggedIn?r.a.createElement(f.a,{to:"/matches"}):null,r.a.createElement("h2",null,"Login"),r.a.createElement(g.a,{onSubmit:this.onSubmit},r.a.createElement(d.a,{name:"name",placeholder:"name",onChange:this.onChange,value:this.state.name}),r.a.createElement("br",null),r.a.createElement(d.a,{name:"url",placeholder:"url",onChange:this.onChange,value:this.state.url}),r.a.createElement("br",null),r.a.createElement(p.a,{type:"submit",color:"primary"},"Submit")))}}]),t}(r.a.Component));var C=function(e){var t=e.user;return r.a.createElement("div",null,r.a.createElement("p",null,"Name: ",t.name))},O=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(i.a)(t).call(this,e))).onChange=function(e){a.setState(Object(h.a)({},e.target.name,parseInt(e.target.value)))},a.onSubmit=function(e){e.preventDefault(),console.log(a.state);var t={input_set_1:"",input_set_2:"",user1_id:a.props.userId,game_configuration_id:a.state.game_configuration_id};y.createMatch(t).then((function(e){a.props.updateCurrentMatch(e.data.id),a.setState({redirect:!0})})).catch(console.log)},a.state={game_configuration_id:0,configurations:[],redirect:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;y.gameConfigurations().then((function(t){console.log(t),e.setState({configurations:t.data})})).catch(console.log)}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.state.redirect?r.a.createElement(f.a,{to:"/match"}):null,r.a.createElement("h2",null,"Create Match"),r.a.createElement(g.a,{onSubmit:this.onSubmit},r.a.createElement("h4",null,"Select a configuration:"),r.a.createElement(d.a,{name:"game_configuration_id",type:"select",onChange:this.onChange},this.state.configurations.map((function(e){return r.a.createElement("option",{value:e.id,key:e.id},"".concat(e.name," (").concat(e.num_matches," matches)"))}))),r.a.createElement("br",null),r.a.createElement(p.a,{type:"submit",color:"primary"},"Submit")))}}]),t}(r.a.Component),j=a(42),M=a(82),I=a(83),k=a(84),U=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(i.a)(t).call(this,e))).getMessages=function(){y.messages(a.state.id).then((function(e){console.log(e);var t=Object(j.a)(new Set(e.data.map((function(e){return e.user_id}))));a.setState({messages:e.data}),a.getUserNames(t)})).catch(console.log),a.timeoutId=setTimeout(a.getMessages,2e3)},a.getUserNames=function(e){e.forEach((function(e){a.state.users.get(e)||y.getUser(e).then((function(t){var n=a.state.users;console.log(t),n.set(e,t.data.name),a.setState({users:n})})).catch(console.log)}))},a.state={id:a.props.id,messages:[],users:new Map},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.getMessages()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeoutId)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(M.a,null,r.a.createElement(I.a,{color:"primary"},"Messages"),this.state.messages.map((function(t,a){return r.a.createElement(I.a,{key:t.id},r.a.createElement(k.a,null,e.state.users.get(t.user_id)),": ",t.content)}))))}}]),t}(r.a.Component),R=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(i.a)(t).call(this,e))).onChange=function(e){"number"===e.target.type?a.setState(Object(h.a)({},e.target.name,parseInt(e.target.value))):a.setState(Object(h.a)({},e.target.name,e.target.value))},a.clearForm=function(){a.setState({content:""})},a.onSubmit=function(e){e.preventDefault(),console.log(a.state);var t={content:a.state.content,user_id:a.state.user_id,match_id:a.state.match_id};y.createMessage(a.state.id,t).then((function(e){a.clearForm()})).catch(console.log)},a.state={match_id:a.props.match_id,user_id:a.props.user_id,content:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(g.a,{onSubmit:this.onSubmit},r.a.createElement(d.a,{name:"content",placeholder:"message",value:this.state.content,onChange:this.onChange}),r.a.createElement("br",null),r.a.createElement(p.a,{type:"submit",color:"primary"},"Send"))}}]),t}(r.a.Component),w=a(85),L=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(i.a)(t).call(this,e))).getMatch=function(){y.match(a.props.matchId).then((function(e){console.log(e);var t=e.data.input_set_1?e.data.input_set_1.trim().split(" "):[],n=e.data.input_set_2?e.data.input_set_2.trim().split(" "):[];if(a.setState({matchData:e.data,numMoves:Math.min(t.length,n.length),player1moves:t,player2moves:n}),a.getUsernames(),null==e.data.user2_id&&a.props.userId!==e.data.user1_id){var r={user2_id:a.props.userId};a.setState({username2:a.props.userName}),y.joinMatch(e.data.id,r).then((function(e){console.log(e)}))}if(0===a.state.input_set.length&&y.gameConfiguration(e.data.game_configuration_id).then((function(e){var t=e.data.input_set.trim().split(" ");a.setState({input_set:t,selectedMove:t[0],gameConfiguration:e.data}),console.log(e)})),y.isGameOver(a.state.player1moves,a.state.player2moves,a.state.gameConfiguration)){var s=y.determineWinner(a.state.player1moves,a.state.player2moves,a.state.input_set);a.setState({finalScore:s,isGameOver:!0})}})).catch(console.log),setTimeout(a.getMatch,2e3)},a.getUsernames=function(){""===a.state.username1&&y.getUser(a.state.matchData.user1_id).then((function(e){a.setState({username1:e.data.name})})).catch(console.log),null!==a.state.matchData.user2_id&&""===a.state.username2&&y.getUser(a.state.matchData.user2_id).then((function(e){a.setState({username2:e.data.name})})).catch(console.log)},a.playMove=function(e){e.preventDefault(),y.play(a.props.matchId,a.props.userId,a.state.selectedMove).then((function(e){a.setState({lastPlayedMove:a.state.selectedMove})})).catch((function(e){alert(e.response.data.error)}))},a.onChange=function(e){a.setState({selectedMove:e.target.value})},a.state={matchData:{},player1moves:[],player2moves:[],numMoves:0,input_set:[],selectedMove:"",username1:"",username2:"",gameConfiguration:{},finalScore:0,isGameOver:!1,lastPlayedMove:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.getMatch()}},{key:"render",value:function(){for(var e=[],t=this.state.numMoves-1;t>=0;t--)e.push(r.a.createElement("tr",null,r.a.createElement("td",null,t+1),r.a.createElement("td",null,this.state.player1moves[t]),r.a.createElement("td",null,this.state.player2moves[t])));var a=[];return this.state.finalScore>0?a.push(r.a.createElement("h1",null,this.state.username1," Won!")):this.state.finalScore<0?a.push(r.a.createElement("h1",null,this.state.username2," Won!")):a.push(r.a.createElement("h1",null,"Draw!")),r.a.createElement("div",null,this.state.isGameOver?a:null,""===this.state.username2?r.a.createElement("h2",null,"Waiting for Player 2 to join..."):null,r.a.createElement("h3",null,"Configuration: ",this.state.gameConfiguration.name," (",this.state.gameConfiguration.num_matches," matches)"),r.a.createElement(g.a,{style:{paddingBottom:"50px",margin:"auto",width:"30%"},onSubmit:this.playMove},r.a.createElement("h2",null,"Play move"),r.a.createElement(d.a,{name:"game_configuration_id",type:"select",onChange:this.onChange},this.state.input_set.map((function(e){return r.a.createElement("option",{value:e},e)}))),r.a.createElement("br",null),r.a.createElement(p.a,{type:"submit",color:"primary"},"Submit Move")),r.a.createElement("h4",null,"Last submitted move: ",this.state.lastPlayedMove),r.a.createElement("h2",null,"Previous Moves"),r.a.createElement(w.a,{style:{marginBottom:"50px"}},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Move"),r.a.createElement("th",null,this.state.username1),r.a.createElement("th",null,""===this.state.username2?"Player 2":this.state.username2))),r.a.createElement("tbody",null,e)),r.a.createElement("div",{style:{margin:"auto",width:"50%"}},r.a.createElement(U,{id:this.props.matchId}),r.a.createElement(R,{match_id:this.props.matchId,user_id:this.props.userId})))}}]),t}(r.a.Component),N=a(14),x=a(41),D=(a(75),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(i.a)(t).call(this,e))).getMatches=function(){y.matches().then((function(e){console.log(e);var t=[],n=[];e.data.forEach((function(e){n.push(e.game_configuration_id),t.push(e.user1_id),e.user2_id&&t.push(e.user2_id)})),a.setState({matches:e.data}),a.getUserNames(t),a.getConfigurations(n)})).catch(console.log),a.timeoutId=setTimeout(a.getMatches,2e3)},a.getUserNames=function(e){e.forEach((function(e){a.state.users.get(e)||y.getUser(e).then((function(t){var n=a.state.users;console.log(t),n.set(e,t.data.name),a.setState({users:n})})).catch(console.log)}))},a.getConfigurations=function(e){e.forEach((function(e){a.state.configurations.get(e)||y.gameConfiguration(e).then((function(t){var n=a.state.configurations;console.log(t),n.set(e,t.data),a.setState({configurations:n})})).catch(console.log)}))},a.onClick=function(e){a.props.updateCurrentMatch(e),a.setState({redirect:!0})},a.state={matches:[],users:new Map,redirect:!1,configurations:new Map},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.getMatches()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeoutId)}},{key:"render",value:function(){var e=this,t=this.state.matches.sort((function(e,t){var a=1;return null===e.user2_id&&null!==t.user2_id?a=-1:null!==e.user2_id&&null===t.user2_id&&(a=1),a})),a=[],n=[],s=!0,l=!1,o=void 0;try{for(var c,u=function(){var t=c.value,s=(m=Object(x.a)(t,2))[0],l=m[1],o=l.input_set_1?l.input_set_1.trim().split(" "):[],u=l.input_set_2?l.input_set_2.trim().split(" "):[],i=e.state.configurations.get(l.game_configuration_id);i&&!y.isGameOver(o,u,i)&&(l.user1_id===e.props.userId||l.user2_id===e.props.userId?a.push(r.a.createElement("tr",{key:s},r.a.createElement("td",null,r.a.createElement(p.a,{className:"button",type:"submit",color:"primary",onClick:function(){e.onClick(l.id)}},"Resume")),r.a.createElement("td",null,e.state.users.get(l.user1_id)),r.a.createElement("td",null,e.state.users.get(l.user2_id)),r.a.createElement("td",null,i?i.name:null))):n.push(r.a.createElement("tr",{key:s},r.a.createElement("td",null,r.a.createElement(p.a,{className:"button",type:"submit",color:"primary",onClick:function(){e.onClick(l.id)}},l.user2_id?"Spectate":"Join")),r.a.createElement("td",null,e.state.users.get(l.user1_id)),r.a.createElement("td",null,e.state.users.get(l.user2_id)),r.a.createElement("td",null,i?i.name:null))))},i=t.entries()[Symbol.iterator]();!(s=(c=i.next()).done);s=!0){var m;u()}}catch(h){l=!0,o=h}finally{try{s||null==i.return||i.return()}finally{if(l)throw o}}return r.a.createElement("div",null,this.state.redirect?r.a.createElement(f.a,{to:"/match"}):null,r.a.createElement("h2",null,"Your Current Matches"),r.a.createElement(w.a,null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Join / Spectate"),r.a.createElement("th",null,"Player 1"),r.a.createElement("th",null,"Player 2"),r.a.createElement("th",null,"Configuration"))),r.a.createElement("tbody",null,a)),r.a.createElement("h2",null,"Other Current Matches"),r.a.createElement(w.a,null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Join / Spectate"),r.a.createElement("th",null,"Player 1"),r.a.createElement("th",null,"Player 2"),r.a.createElement("th",null,"Configuration"))),r.a.createElement("tbody",null,n)))}}]),t}(r.a.Component)),P=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(p.a,{style:{marginBottom:"50px"},type:"submit",color:"primary"},r.a.createElement(N.b,{style:{color:"white"},to:"/config_creator"},"Create a Configuration")),r.a.createElement("br",null),r.a.createElement(p.a,{style:{marginBottom:"50px"},type:"submit",color:"primary"},r.a.createElement(N.b,{style:{color:"white"},to:"/create"},"Create a Match")),r.a.createElement(D,{updateCurrentMatch:this.props.updateCurrentMatch,userId:this.props.userId}))}}]),t}(r.a.Component),W=(a(76),a(86)),G=a(87),z=a(88),B=a(89),F=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"header"},r.a.createElement(W.a,{color:"light",light:!0,expand:"md"},r.a.createElement(G.a,{style:{fontSize:"40px"}},r.a.createElement(N.b,{style:{color:"black"},to:"/login"},"RockPaperBazooka")),r.a.createElement(z.a,{className:"ml-auto",navbar:!0},r.a.createElement(B.a,null,r.a.createElement(N.b,{style:{fontSize:"24px",paddingRight:"50px"},to:"/matches"},"Matches")),r.a.createElement(B.a,null,r.a.createElement(N.b,{style:{fontSize:"24px",paddingRight:"50px"},to:"/user"},"User")))))}}]),t}(r.a.Component),T=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(i.a)(t).call(this,e))).updateName=function(e,t){a.setState({name:e,id:t})},a.updateCurrentMatch=function(e){a.setState({currentMatchId:e})},a.state={name:"",id:2,currentMatchId:3},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(N.a,null,r.a.createElement("div",{className:"App"},r.a.createElement(F,null),r.a.createElement(f.d,null,r.a.createElement(f.b,{path:"/config_creator"},r.a.createElement(_,null)," ",r.a.createElement("br",null)),r.a.createElement(f.b,{path:"/create"},r.a.createElement(O,{userId:this.state.id,updateCurrentMatch:this.updateCurrentMatch})),r.a.createElement(f.b,{path:"/match"},r.a.createElement(L,{matchId:this.state.currentMatchId,userId:this.state.id,userName:this.state.name})),r.a.createElement(f.b,{path:"/matches"},r.a.createElement(P,{updateCurrentMatch:this.updateCurrentMatch,userId:this.state.id})),r.a.createElement(f.b,{path:"/user"},r.a.createElement(C,{user:{name:this.state.name}})),r.a.createElement(f.b,{path:"/"},r.a.createElement(S,{updateName:this.updateName})))))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(77);l.a.render(r.a.createElement(T,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[43,1,2]]]);
//# sourceMappingURL=main.695bae1f.chunk.js.map